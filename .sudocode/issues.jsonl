{"id":"i-2laf","uuid":"8ce56f26-255a-4c2c-b88d-a3dcbcd3f578","title":"Implement AgentHandle","content":"Create `src/agent-handle.ts`:\n- Spawn subprocess with `child_process.spawn()`\n- Set up NDJSON streams via `acp.ndJsonStream()`\n- Create `ClientSideConnection` with ACPClientHandler\n- Call `initialize()` and store capabilities\n- Implement `createSession()`, `loadSession()`, `close()`\n\nImplements [[s-6t4r]]","status":"open","priority":1,"assignee":null,"archived":0,"archived_at":null,"created_at":"2025-12-11 19:31:25","updated_at":"2025-12-11 19:53:46","closed_at":null,"parent_id":null,"parent_uuid":null,"relationships":[{"from":"i-2laf","from_type":"issue","to":"i-63n6","to_type":"issue","type":"depends-on"},{"from":"i-2laf","from_type":"issue","to":"s-6t4r","to_type":"spec","type":"implements"}],"tags":["core"]}
{"id":"i-63n6","uuid":"12d41b03-f4dd-49cd-a61e-c42b1749e983","title":"Implement ACPClientHandler","content":"Create `src/client-handler.ts` implementing `acp.Client`:\n- `requestPermission()` - delegate to callback or auto-approve/deny based on mode\n- `sessionUpdate()` - push updates to per-session async iterators\n- `readTextFile()` - delegate to callback or default to fs.readFile\n- `writeTextFile()` - delegate to callback or default to fs.writeFile\n- Terminal operations (createTerminal, etc.)\n\nUse pushable async iterator pattern for streaming updates.\n\nImplements [[s-6t4r]]","status":"closed","priority":1,"assignee":null,"archived":0,"archived_at":null,"created_at":"2025-12-11 19:31:25","updated_at":"2025-12-11 19:53:46","closed_at":"2025-12-11 19:53:46","parent_id":null,"parent_uuid":null,"relationships":[{"from":"i-63n6","from_type":"issue","to":"i-8q1l","to_type":"issue","type":"depends-on"},{"from":"i-63n6","from_type":"issue","to":"s-6t4r","to_type":"spec","type":"implements"}],"tags":["core"],"feedback":[{"id":"11e10d15-ab23-4139-ae5c-cc374b95b779","from_id":"i-63n6","to_id":"s-6t4r","feedback_type":"comment","content":"## Implementation Complete\n\nImplemented `src/client-handler.ts` with full ACP Client interface:\n\n### Pushable Class\n- Generic async iterable for bridging push-based to async-iterator-based code\n- Methods: `push()`, `end()`, `isDone()`\n- Used to stream session updates to consumers\n\n### ACPClientHandler\nImplements `acp.Client` interface with:\n\n**Permission Handling:**\n- `auto-approve`: Selects `allow_once` or `allow_always` option\n- `auto-deny`: Selects `reject_once` or `reject_always` option  \n- `callback`: Delegates to `onPermissionRequest` handler\n- Fallback chain: callback â†’ first option\n\n**Session Updates:**\n- Per-session pushable streams via `Map<sessionId, Pushable<SessionUpdate>>`\n- `getSessionStream(sessionId)` - get/create stream for session\n- `endSessionStream(sessionId)` - signal stream completion\n\n**File Operations:**\n- `readTextFile()` - custom handler or fs.readFile\n- `writeTextFile()` - custom handler or fs.writeFile\n\n**Terminal Operations:**\n- `createTerminal()` - requires handler\n- `terminalOutput()` - requires handler\n- `killTerminal()` - requires handler\n- `releaseTerminal()` - requires handler\n- `waitForTerminalExit()` - requires handler\n\n### Verification\n- Build passes successfully","agent":"alexngai","anchor":null,"dismissed":false,"created_at":"2025-12-11T19:53:46.803Z","updated_at":"2025-12-11T19:53:46.803Z"}]}
{"id":"i-6lcd","uuid":"83943996-5a82-4e3e-95ab-0ad7b011b91f","title":"Set up acp-factory project structure","content":"Initialize the TypeScript project with:\n- `package.json` with `@agentclientprotocol/sdk` dependency\n- `tsconfig.json` for TypeScript configuration\n- Basic file structure under `src/`\n\nImplements [[s-6t4r]]","status":"closed","priority":1,"assignee":null,"archived":0,"archived_at":null,"created_at":"2025-12-11 19:31:25","updated_at":"2025-12-11 19:40:54","closed_at":"2025-12-11 19:40:54","parent_id":null,"parent_uuid":null,"relationships":[{"from":"i-6lcd","from_type":"issue","to":"s-6t4r","to_type":"spec","type":"implements"}],"tags":["setup"],"feedback":[{"id":"0e6e8fcd-a6f7-4b15-88a4-b85b140d120b","from_id":"i-6lcd","to_id":"s-6t4r","feedback_type":"comment","content":"## Implementation Complete\n\nCreated the project structure with:\n\n### Files Created\n- `package.json` - Dependencies: `@agentclientprotocol/sdk` v0.8.0\n- `tsconfig.json` - ES2022 target, NodeNext modules, strict mode\n- `src/index.ts` - Public exports\n- `src/types.ts` - Type definitions with re-exports from ACP SDK\n- `src/factory.ts` - AgentFactory with static registry\n- `src/agent-handle.ts` - AgentHandle skeleton (TODO stubs)\n- `src/session.ts` - Session skeleton (TODO stubs)\n- `src/client-handler.ts` - ACPClientHandler skeleton (TODO stubs)\n- `src/providers/claude-code.ts` - Claude Code config (npx @zed-industries/claude-code-acp)\n\n### Verification\n- `npm install` succeeded (48 packages)\n- `npm run build` succeeded\n- `dist/` contains all compiled JS and declaration files\n\n### Notes\n- Used same ACP SDK version (0.8.0) as claude-code-acp reference\n- Skeleton files have TODO stubs referencing the next issues in the chain","agent":"alexngai","anchor":null,"dismissed":false,"created_at":"2025-12-11T19:40:54.490Z","updated_at":"2025-12-11T19:40:54.490Z"}]}
{"id":"i-8q1l","uuid":"aa56a4e9-feaf-4660-8cbd-e54352664721","title":"Implement core types","content":"Create `src/types.ts` with:\n- `AgentConfig` interface\n- `SpawnOptions` interface  \n- `SessionOptions` interface\n- `PermissionMode` enum (auto-approve, auto-deny, require-callback)\n- Re-export relevant ACP types\n\nImplements [[s-6t4r]]","status":"closed","priority":1,"assignee":null,"archived":0,"archived_at":null,"created_at":"2025-12-11 19:31:25","updated_at":"2025-12-11 19:46:37","closed_at":"2025-12-11 19:46:37","parent_id":null,"parent_uuid":null,"relationships":[{"from":"i-8q1l","from_type":"issue","to":"i-6lcd","to_type":"issue","type":"depends-on"},{"from":"i-8q1l","from_type":"issue","to":"s-6t4r","to_type":"spec","type":"implements"}],"tags":["types"],"feedback":[{"id":"02444ab8-4988-4011-b50e-239c8bd0273c","from_id":"i-8q1l","to_id":"s-6t4r","feedback_type":"comment","content":"## Implementation Complete\n\nEnhanced `src/types.ts` with comprehensive type definitions:\n\n### Library Types (defined)\n- `AgentConfig` - Agent spawn configuration\n- `SpawnOptions` - Options for spawning (extends ClientHandlers)\n- `SessionOptions` - Session creation options\n- `PermissionMode` - \"auto-approve\" | \"auto-deny\" | \"callback\"\n- `ClientHandlers` - Callbacks for permissions, file ops, terminals\n- `PromptContent` - string | ContentBlock[]\n\n### Re-exported ACP Types (organized by category)\n- **Core**: SessionUpdate, ContentBlock, TextContent, ImageContent, ResourceLink, AgentCapabilities, StopReason\n- **Tools**: ToolCall, ToolCallUpdate, ToolCallStatus, ToolCallContent, ToolCallLocation\n- **Permissions**: RequestPermissionRequest, RequestPermissionResponse, PermissionOption\n- **Terminals**: CreateTerminalRequest, CreateTerminalResponse, TerminalOutputRequest, TerminalOutputResponse\n- **MCP**: McpServer, McpServerStdio, McpServerHttp, McpServerSse\n- **Responses**: NewSessionResponse, PromptResponse, InitializeRequest, InitializeResponse\n\n### Verification\n- Build passes successfully\n- All types properly exported from index.ts","agent":"alexngai","anchor":null,"dismissed":false,"created_at":"2025-12-11T19:46:37.789Z","updated_at":"2025-12-11T19:46:37.789Z"}]}
{"id":"i-33nu","uuid":"268b184d-9baf-4c3a-b6ec-92871b6c7838","title":"Create public exports and integration test","content":"Create `src/index.ts` with public API exports.\n\nWrite integration test that:\n- Spawns Claude Code agent\n- Creates session\n- Sends prompt\n- Receives streaming updates\n- Verifies end-to-end flow works\n\nImplements [[s-6t4r]]","status":"blocked","priority":2,"assignee":null,"archived":0,"archived_at":null,"created_at":"2025-12-11 19:31:26","updated_at":"2025-12-11 19:33:33","closed_at":null,"parent_id":null,"parent_uuid":null,"relationships":[{"from":"i-33nu","from_type":"issue","to":"i-6r3p","to_type":"issue","type":"depends-on"},{"from":"i-33nu","from_type":"issue","to":"s-6t4r","to_type":"spec","type":"implements"}],"tags":["test"]}
{"id":"i-6r3p","uuid":"e822fd4f-930d-443c-8d84-0d23de77fcb3","title":"Implement AgentFactory","content":"Create `src/factory.ts`:\n- Static registry map of agent configs\n- `register(name, config)` to add agent types\n- `spawn(name, options)` to create AgentHandle instances\n- Pre-register \"claude-code\" provider on module load\n\nAlso create `src/providers/claude-code.ts` with Claude Code config.\n\nImplements [[s-6t4r]]","status":"blocked","priority":1,"assignee":null,"archived":0,"archived_at":null,"created_at":"2025-12-11 19:31:26","updated_at":"2025-12-11 19:33:33","closed_at":null,"parent_id":null,"parent_uuid":null,"relationships":[{"from":"i-6r3p","from_type":"issue","to":"i-2laf","to_type":"issue","type":"depends-on"},{"from":"i-6r3p","from_type":"issue","to":"s-6t4r","to_type":"spec","type":"implements"}],"tags":["core"]}
{"id":"i-90yy","uuid":"14a2a1be-b680-40f4-8069-9f2b43afbb97","title":"Implement Session","content":"Create `src/session.ts`:\n- Store session ID, modes, models\n- Implement `prompt()` returning `AsyncIterable<SessionUpdate>`\n- Implement `cancel()` to abort in-flight prompts\n- Implement `setMode()` for mode switching\n\nImplements [[s-6t4r]]","status":"open","priority":1,"assignee":null,"archived":0,"archived_at":null,"created_at":"2025-12-11 19:31:26","updated_at":"2025-12-11 19:46:37","closed_at":null,"parent_id":null,"parent_uuid":null,"relationships":[{"from":"i-90yy","from_type":"issue","to":"i-8q1l","to_type":"issue","type":"depends-on"},{"from":"i-90yy","from_type":"issue","to":"s-6t4r","to_type":"spec","type":"implements"}],"tags":["core"]}
